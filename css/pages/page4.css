/*
 * ===================================================================
 *                          css/pages/page4.css
 *                     页面4样式（V5.0 标准注释版）
 * -------------------------------------------------------------------
 * 目标：遵循《项目前端开发与维护黄金标准》，实现样式完全沙箱化、
 *      注释结构化分层，并在关键参数处提供可调节说明与影响分析。
 * 适用范围：仅作用于 #page4-container 内部元素，避免全局污染。
 * ===================================================================
 */

/* --- 核心冲突修复：布局豁免 --- */
/*
  这个规则的优先级高于 main.css 中的 .layout-centered，
  因为它使用了 ID选择器(#)，而 main.css 使用的是类选择器(.)。
*/
#page4-container {
    /* 1. 强制解除 main.css 的 flex 布局影响，回归到标准的块级布局 */
    display: block !important;

    /* 2. 重置 flex 相关的对齐属性，避免任何残留影响 */
    justify-content: initial;
    align-items: initial;

    /* 3. 移除 main.css 可能添加的内边距，确保内部绝对定位的坐标系正确 */
    padding: 0;
}

/*
 * ===================================================================
 *                      1. 沙箱与页面容器约定
 * -------------------------------------------------------------------
 * - 所有选择器均以 #page4-container 开头，确保作用域限定在页面4。
 * - 页面内部包装层（如 .timeline-canvas/.timeline-stage/.stage-content）承担布局与动画职责。
 * - 禁止直接给 body/h1/p 等标签设样式；必须通过带前缀的类选择器。
 * - 动画如需新增，建议采用 page4-* 前缀命名以避免跨页冲突。
 * ===================================================================
 */

/* 2. 页面根容器（Root Container）
 * 职责：提供主题变量、背景与文本颜色的统一入口。
 * 关键参数与影响：
 *   - CSS 变量：--page4-bg-color/--page4-text-color/--page4-primary-color 等用于统一主题；
 *   - background-*：背景图与位置；cover 可能裁剪，contain 保留全图可能留白；
 *   - overflow: hidden 避免内部绝对定位元素溢出产生滚动条。
 * 调节建议：
 *   - 根据页面主题在根上调整变量，保证文本与背景对比度充足。
 */
#page4-container {
    --page4-bg-color: #FFFBF0;
    --page4-text-color: #3D3D3D;
    --page4-primary-color: #C74646;
    --page4-line-color: #E0DCD1;
    --page4-year-color: #A0988A;
    background-color: var(--page4-bg-color);
    background-image: url('../../image/（1-6）68a725b2d3e64.png');
    background-size: cover;
    background-position: center;
    color: var(--page4-text-color);
    overflow: hidden;
}

/* 3. 页头（Header）
 * 职责：展示标题并在合适时机淡入。
 * 关键参数与影响：
 *   - position: absolute 将其定位在右下角；
 *   - opacity/transition 控制淡入动画；
 *   - 字体族使用 serif 提升时间线叙事感。
 */
#page4-container .page-header {
    position: absolute; 
    bottom: 5vh;
    right: 5vw;
    z-index: 100;
    opacity: 0;
    transition: opacity 1s;
    text-align: right;
}
#page4-container .page-header.is-visible { opacity: 1; }
#page4-container .page-header h1 {
    font-family: 'Noto Serif SC', serif;
    font-size: 3rem;
    font-weight: bold;
    margin: 0;
    color: var(--page4-primary-color);
    line-height: 1.2;
}

/* 4. 时间线画布与路径（Timeline Canvas & Paths）
 * 职责：承载可视化时间线与进度绘制。
 * 关键参数与影响：
 *   - transform: translate(-50%, -50%) 将画布居中；
 *   - transition: transform 采用缓动曲线，增强移动时的平滑感；
 *   - path 样式中 stroke 系列控制线条风格与进度动画。
 */
#page4-container .timeline-canvas {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 1400px;
    height: 700px;
    transform: translate(-50%, -50%);
    transition: transform 1.2s cubic-bezier(0.65, 0, 0.35, 1);
}
#page4-container .timeline-paths { position: absolute; width: 100%; height: 100%; }
#page4-container .timeline-paths path { stroke-width: 3; fill: none; }
#page4-container #path-bg { stroke: var(--page4-line-color); }
#page4-container #path-future { stroke: var(--page4-line-color); stroke-dasharray: 8 8; }
#page4-container #path-progress {
    stroke: var(--page4-primary-color);
    stroke-dasharray: 1;
    stroke-dashoffset: 1;
    transition: stroke-dashoffset 1.0s ease-in-out;
}

/* 5. 年份标记与阶段（Year Marker & Stage）
 * 职责：标记年份并控制各阶段的激活与内容展示。
 * 关键参数与影响：
 *   - year-marker 使用旋转与透明度动画营造时间轴感；
 *   - .timeline-stage 配合 .is-active 管理节点与内容入场；
 *   - .node 通过边框色与缩放突出当前阶段。
 */
#page4-container .year-marker {
    position: absolute;
    color: var(--page4-year-color);
    font-size: 16px;
    font-weight: 500;
    transform-origin: center center;
    transform: translate(-50%, -35px) rotate(45deg);
    opacity: 0;
    transition: opacity 0.5s;
}
#page4-container .year-marker.is-visible { opacity: 1; }
#page4-container .timeline-stage { position: absolute; }
#page4-container .node {
    width: 24px;
    height: 24px;
    background: var(--page4-bg-color);
    border: 3px solid var(--page4-line-color);
    border-radius: 50%;
    position: absolute;
    transform: translate(-50%, -50%);
    transition: border-color 0.5s, transform 0.5s;
}
#page4-container.is-overview .timeline-stage .node,
#page4-container .timeline-stage.is-active .node { border-color: var(--page4-primary-color); }
#page4-container .timeline-stage.is-active .node { transform: translate(-50%, -50%) scale(1.1); }

/* 6. 阶段内容（Stage Content）
 * 职责：在阶段激活或总览模式下淡入展示内容。
 * 关键参数与影响：
 *   - opacity/transform 控制入场动画；
 *   - pointer-events: none 防止未激活内容响应交互。
 */
#page4-container .stage-content {
    position: absolute;
    width: 400px;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
    pointer-events: none;
}
#page4-container .timeline-stage.is-active .stage-content { opacity: 1; transform: translateY(0); }
#page4-container.is-overview .timeline-stage .stage-content { opacity: 1; transform: translateY(0); }
#page4-container [data-side="left"] .stage-content { right: 50px; bottom: 0; text-align: right; }
#page4-container [data-side="right"] .stage-content { left: 50px; top: 0; text-align: left; }
#page4-container .stage-content h2 { font-family: 'Noto Serif SC', serif; font-size: 3rem; color: var(--page4-primary-color); margin: 0; line-height: 1.2; }
#page4-container .stage-content .date { font-size: 1.2rem; color: var(--page4-year-color); margin: 5px 0 20px 0; display: block; }
#page4-container .stage-content .details { font-size: 1rem; line-height: 1.9; color: var(--page4-text-color); padding-left: 15px; border-left: 3px solid var(--page4-primary-color); }
#page4-container [data-side="left"] .details { padding-left: 0; padding-right: 15px; border-left: none; border-right: 3px solid var(--page4-primary-color); }

/* 7. 续作提示（To Be Continued）
 * 职责：总览模式下展示延续提示文案。
 * 关键参数与影响：
 *   - transform: translate + rotate 保持与时间线视觉一致；
 *   - opacity 通过总览模式控制显示。
 */
#page4-container #to-be-continued {
    position: absolute;
    color: var(--page4-year-color);
    font-size: 14px;
    transform: translate(20px, -50%) rotate(45deg);
    opacity: 0;
    transition: opacity 1s;
}
#page4-container.is-overview #to-be-continued { opacity: 1; }

/*
 * ===================================================================
 *                          8. 合规性自检（SOP）
 * -------------------------------------------------------------------
 * - CSS 沙箱化：已全部使用 #page4-container 前缀（符合法则二第1条）。
 * - 禁止标签选择器：未对 body/h1/p 等标签直接设样式（符合法则二第3条）。
 * - 动画命名：当前未定义 @keyframes；若后续添加，建议采用 page4-* 前缀（符合法则二第2条推荐）。
 * - 包装器职责：时间线相关容器布局与职责明确（符合法则一关于内层包装器）。
 * - 综述：页面4样式总体遵循 SOP 要求，后续扩展请保持前缀与沙箱策略。
 * ===================================================================
 */
